# 'No such file or directory' - error opening terragrunt.hcl files after Terraform update

**adoylesimplisafe** commented *Sep 5, 2019*

Terraform:
```
Terraform version: 0.12.8
Go runtime version: go1.13
terragrunt version v0.19.23
bash3.2
OSX 10.14.6
```

Upgraded to TF 12.8 from 0.12.7, I believe I was already on TG 0.19.23, state had already been applied mostly using `apply-all` but I had run into a dependency issue where a dependency was honored in one place but not another.  Upgraded Terraform as a test, and now have entirely new error output:

```
bash-3.2$ terragrunt destroy-all
[terragrunt] 2019/09/05 17:31:37 Setting download directory for module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra to /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/.terragrunt-cache
[terragrunt] 2019/09/05 17:31:37 Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra does not have an associated terraform configuration and will be skipped.
[terragrunt] 2019/09/05 17:31:37 Setting download directory for module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network to /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network/.terragrunt-cache
[terragrunt] 2019/09/05 17:31:37 Setting download directory for module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web to /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/.terragrunt-cache
[terragrunt] 2019/09/05 17:31:37 Setting download directory for module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups to /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups/.terragrunt-cache
[terragrunt] 2019/09/05 17:31:37 Setting download directory for module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users to /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users/.terragrunt-cache
[terragrunt] 2019/09/05 17:31:37 Stack at /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra:
  => Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network (excluded: false, dependencies: [])
  => Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups])
  => Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups (excluded: false, dependencies: [])
  => Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users (excluded: false, dependencies: [])
[terragrunt] 2019/09/05 17:31:37 [terragrunt]  WARNING: Are you sure you want to run `terragrunt destroy` in each folder of the stack described above? There is no undo! (y/n)
y
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users] 2019/09/05 17:31:38 Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users must wait for 1 dependencies to finish
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups] 2019/09/05 17:31:38 Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups must wait for 1 dependencies to finish
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network] 2019/09/05 17:31:38 Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network must wait for 1 dependencies to finish
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web] 2019/09/05 17:31:38 Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web must wait for 0 dependencies to finish
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web] 2019/09/05 17:31:38 Running module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web now
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web] 2019/09/05 17:31:38 Reading Terragrunt config file at /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/terragrunt.hcl
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web] 2019/09/05 17:31:38 Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web has finished with an error: Error reading file at path /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: no such file or directory
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups] 2019/09/05 17:31:38 Dependency /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web of module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups just finished with an error. Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups will have to return an error too.
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users] 2019/09/05 17:31:38 Dependency /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web of module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users just finished with an error. Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users will have to return an error too.
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network] 2019/09/05 17:31:38 Dependency /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web of module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network just finished with an error. Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network will have to return an error too.
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users] 2019/09/05 17:31:38 Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users has finished with an error: Cannot process module Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users (excluded: false, dependencies: []) because one of its dependencies, Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups]), finished with an error: Error reading file at path /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: no such file or directory
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups] 2019/09/05 17:31:38 Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups has finished with an error: Cannot process module Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups (excluded: false, dependencies: []) because one of its dependencies, Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups]), finished with an error: Error reading file at path /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: no such file or directory
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network] 2019/09/05 17:31:38 Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network has finished with an error: Cannot process module Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network (excluded: false, dependencies: []) because one of its dependencies, Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups]), finished with an error: Error reading file at path /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: no such file or directory
[terragrunt] 2019/09/05 17:31:38 Encountered the following errors:
Cannot process module Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network (excluded: false, dependencies: []) because one of its dependencies, Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups]), finished with an error: Error reading file at path /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: no such file or directory
Error reading file at path /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: no such file or directory
Cannot process module Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups (excluded: false, dependencies: []) because one of its dependencies, Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups]), finished with an error: Error reading file at path /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: no such file or directory
Cannot process module Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users (excluded: false, dependencies: []) because one of its dependencies, Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups]), finished with an error: Error reading file at path /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: no such file or directory
[terragrunt] 2019/09/05 17:31:38 Unable to determine underlying exit code, so Terragrunt will exit with error code 1
```

It seems it's no longer able to honor any of dependencies. I can post all of the `terragrunt.hcl` file, but I'm not sure they're inherently flawed since I was able to apply the entire state before the upgrade.  An example:

```
terraform {
  source = "git::git@github.com:adoylesimplisafe/tf-sg-test.git"
}

# Include all settings from the root terragrunt.hcl file
include {
  path = "${get_terragrunt_dir()}/../../../../../../terragrunt.hcl"
}

dependency "network" {
  config_path = "${get_terragrunt_dir()}/../../../network"
}

# These are the variables we have to pass in to use the module specified in the terragrunt configuration above
inputs = {
  name          = "webserver-example-qa"
  instance_type = "t2.micro"

  min_size = 2
  max_size = 2

  server_port = 8080
  elb_port    = 80

  vpc_id = "dependency.network.outputs.vpc_id"
}
```

Tree output:
```
├── environments
│   └── qa
│       └── us-east-2
│           ├── network
│           │   └── terragrunt.hcl
│           └── services
│               └── web
│                   ├── security_groups
│                   │   └── terragrunt.hcl
│                   └── terragrunt.hcl
├── iam
│   └── users
│       └── terragrunt.hcl
└── terragrunt.hcl
```


<br />
***


**yorinasub17** commented *Sep 5, 2019*

Looking at the logs, the following line appears to be the critical error:

```
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web] 2019/09/05 17:31:38 Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web has finished with an error: Error reading file at path /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/terragrunt.hcl: no such file or directory
```

There appears to be a misconfiguration in your `environments/qa/us-east-2/services/web` live config where it is trying to look for `environments/terragrunt.hcl`. My guess is that you are missing an extra `..`?

That doesn't explain why you were able to successfully apply originally. Would need to see the `services/web` module config to understand better.

---

By the way, `vpc_id = "dependency.network.outputs.vpc_id"` should be `vpc_id = dependency.network.outputs.vpc_id`, without the quotes.
***

**adoylesimplisafe** commented *Sep 6, 2019*

Thank you for your quick response!

This is indeed a weird error because the `apply-all` operation worked fine before upgrading Terraform.  So I'm not sure if this is a Terraform or Terragrunt issue.

`terraform 0.12.7 -> 0.12.8`

`terragrunt 0.19.21 -> 0.19.23`

I had performed the upgrade because I was working through another issue where Terragrunt wasn't properly working with a dependency and the `web` module was failing to apply:

First error:
```
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups] 2019/09/05 16:40:58 Running command: terraform apply -input=false -auto-approve

Error: Unassigned variable

The input variable "vpc_id" has not been assigned a value. This is a bug in
Terraform; please report it in a GitHub issue.
```

Second error:
```
[terragrunt] [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network] 2019/09/05 16:41:10 Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network has finished successfully!
[terragrunt] 2019/09/05 16:41:10 Encountered the following errors:
Cannot process module Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/network, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/iam/users, /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups]) because one of its dependencies, Module /Users/andrewdoyle/ss_prototypes/ss_infrastructure/accounts/infra/environments/qa/us-east-2/services/web/security_groups (excluded: false, dependencies: []), finished with an error: Hit multiple errors:
exit status 1
Hit multiple errors:
exit status 1
```

So then from there, I did an upgrade after seeing there were some possible fixes to the dependency stuff, but that appeared to break things even more.

Thanks again let me know what other information I can provide.
***

**yorinasub17** commented *Sep 6, 2019*

Can you share your terragrunt config for `environments/qa/us-east-2/services/web`?

Also I can help try to understand what was originally wrong if you can share what `environments/qa/us-east-2/services/web/security_groups` was before your upgrade.
***

**adoylesimplisafe** commented *Sep 6, 2019*

The `web` config.

```
terraform {
  source = "git::git@github.com:adoylesimplisafe/terragrunt-infrastructure-modules-example.git//asg-elb-service?ref=v0.1.0"
}

# Include all settings from the root terragrunt.hcl file
include {
  path = "../../../../../terragrunt.hcl"
}

dependency "network"{
    config_path = "../../network"
}

# Require dependency for IAM role, doesn't actually do anything yet
dependency "iam"{
    config_path = "../../../../../iam/users"
}

dependency "security_groups"{
    config_path = "./security_groups"
}

# These are the variables we have to pass in to use the module specified in the terragrunt configuration above
inputs = {
  name          = "webserver-example-qa"
  instance_type = "t2.micro"

  min_size = 2
  max_size = 2

  server_port = 8080
  elb_port    = 80

  asg_security_group_id = "dependency.security_groups.outputs.asg_security_group_id"
  elb_security_group_id = "dependency.security_groups.outputs.elb_security_group_id"
  aws_vpc_zone_ids      = "dependency.network.outputs.private_subnets"
}
```

The `security_groups` config:
```
terraform {
  source = "git::git@github.com:adoylesimplisafe/tf-sg-test.git"
}

# Include all settings from the root terragrunt.hcl file
include {
  path = "../../../../../../terragrunt.hcl"
}

# These are the variables we have to pass in to use the module specified in the terragrunt configuration above
inputs = {
  name          = "webserver-example-qa"
  instance_type = "t2.micro"

  min_size = 2
  max_size = 2

  server_port = 8080
  elb_port    = 80
}
```

Thanks!
***

**yorinasub17** commented *Sep 6, 2019*

For the original error, that is because your module (`adoylesimplisafe/tf-sg-test`) requires the input variable `vpc_id` and it looks like that isn't being passed in. It looks like you are fixing that now with the `dependency` block.

---

For the current error, I am not 100% sure what is going on, but one thing you can try is follow the pattern of using `find_in_parent_folders` to include the parent config, as opposed to manually building the path. See [the corresponding section in the README](https://github.com/gruntwork-io/terragrunt#filling-in-remote-state-settings-with-terragrunt) for more details.

---

Don't forget to drop the quotes here! Otherwise, you're setting these values to the literal string you have there.

```
  asg_security_group_id = "dependency.security_groups.outputs.asg_security_group_id"
  elb_security_group_id = "dependency.security_groups.outputs.elb_security_group_id"
  aws_vpc_zone_ids      = "dependency.network.outputs.private_subnets"
```
***

**adoylesimplisafe** commented *Sep 6, 2019*

Yeah, that initial variable issue was what I thought I had inherently attended to with the dependencies, because it was working with the security group IDs in the same fashion (no defaults for those variables in the module itself).  I understand that there are existing issues with this from the Terraform perspective because a `plan` doesn't supply an output (maybe it should supply mock outputs in the future?)

The issue I ran into with the `find_in_parent_folders()` function was that it was pulling in `terragrunt.hcl` files that were not the root file with the backend defined, so I switched to explicit paths just to maintain forward progress.  Perhaps I'll try to figure that out.
***

**yorinasub17** commented *Sep 6, 2019*

> The issue I ran into with the find_in_parent_folders() function was that it was pulling in terragrunt.hcl files that were not the root file with the backend defined, so I switched to explicit paths just to maintain forward progress. Perhaps I'll try to figure that out.

This is because it looks for the first `terragrunt.hcl` that exists in the parent. So I can see this NOT working for your directory structure in the `security-groups` module, because it will find the `terragrunt.hcl` in the first parent (`web`). But for `web`, the first parent with a `terragrunt.hcl` is `environment`.

---

>  I understand that there are existing issues with this from the Terraform perspective because a plan doesn't supply an output (maybe it should supply mock outputs in the future?)

See https://github.com/gruntwork-io/terragrunt#unapplied-dependency-and-mock-outputs
***

**adoylesimplisafe** commented *Sep 6, 2019*

Regarding the above error -
```
Cannot process module Module /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/network (excluded: false, dependencies: []) because one of its dependencies, Module /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/network, /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/iam/users, /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web/security_groups]), finished with an error: Error reading file at path /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/terragrunt.hcl: no such file or directory
```
I'm not entirely sure what it's suggesting, because so far as I can tell the paths I have defined are correct.

From the `terragrunt.hcl` in `web`:

```
# Include all settings from the root terragrunt.hcl file
include {
  path = "../../../../../terragrunt.hcl"
}

dependency "network" {
  config_path = "../../network"
}

# Require dependency for IAM role, doesn't actually do anything yet
dependency "iam" {
  config_path = "../../../../../iam/users"
}

dependency "security_groups" {
  config_path = "./security_groups"
}
```

Quick test:
```
> pwd
/Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web

> ls ../../../../../              
environments   iam            terragrunt.hcl

> ls ../../network
terragrunt.hcl

ls ./security_groups 
terragrunt.hcl
```

Is this possibly some sort of cyclical dependency issue? I performed the above tests quickly in all the directories I have and the path definitions appear to be correct.
***

**adoylesimplisafe** commented *Sep 6, 2019*

FYI @yorinasub17 , reverting back to 0.19.21 (the version I was originially working with) resolved that immediate issue regarding the `Cannot process module...` errors above.
***

**yorinasub17** commented *Sep 6, 2019*

On terragrunt 0.19.23, can you rerun `terragrunt plan` in the folder `/Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web` with the environment variable `TERRAGRUNT_DEBUG=true`? This will show a stack trace which will help pinpoint what might be causing that.
***

**adoylesimplisafe** commented *Sep 6, 2019*

```Cannot process module Module /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/network, /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/iam/users, /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web/security_groups]) because one of its dependencies, Module /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web/security_groups (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/network]), finished with an error: Error reading file at path /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/terragrunt.hcl: no such file or directory
Error reading file at path /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/terragrunt.hcl: no such file or directory
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/configstack/running_module.go:179 (0x1971ff5)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/configstack/running_module.go:163 (0x1971e26)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/configstack/running_module.go:62 (0x19711ed)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/configstack/stack.go:74 (0x1973bbf)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:708 (0x197c2e5)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:644 (0x197bc3c)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:223 (0x1978f76)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:206 (0x1978cd6)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/vendor/github.com/urfave/cli/app.go:490 (0x19164a8)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/vendor/github.com/urfave/cli/app.go:264 (0x19146ac)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/main.go:23 (0x19815de)
/usr/local/Cellar/go/1.13/libexec/src/runtime/proc.go:203 (0x10310ee)
/usr/local/Cellar/go/1.13/libexec/src/runtime/asm_amd64.s:1357 (0x105d141)

[terragrunt] 2019/09/06 15:41:25 Unable to determine underlying exit code, so Terragrunt will exit with error code 1```

***

**yorinasub17** commented *Sep 6, 2019*

Did you run that in the right directory? It looks like it is running in `/Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa`
***

**adoylesimplisafe** commented *Sep 6, 2019*

Yes, I'm running from the top-level `infra` directory - I noticed the error message changed as well, but regardless it appears to be a symptom of the same issue I reported before - this error re-appeared switching back to `23` from `21`.  I'll try to reproduce the original error.
***

**adoylesimplisafe** commented *Sep 6, 2019*

Interesting, the errors are different between `plan-all` and `destroy-all` (listed respectively):
```
[terragrunt] 2019/09/06 16:28:56 configstack.MultiError Encountered the following errors:
Cannot process module Module /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/network, /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/iam/users, /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web/security_groups]) because one of its dependencies, Module /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web/security_groups (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/network]), finished with an error: Error reading file at path /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/terragrunt.hcl: no such file or directory
Error reading file at path /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/terragrunt.hcl: no such file or directory
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/configstack/running_module.go:179 (0x1971ff5)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/configstack/running_module.go:163 (0x1971e26)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/configstack/running_module.go:62 (0x19711ed)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/configstack/stack.go:42 (0x1973627)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:690 (0x197c196)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:642 (0x197bc68)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:223 (0x1978f76)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:206 (0x1978cd6)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/vendor/github.com/urfave/cli/app.go:490 (0x19164a8)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/vendor/github.com/urfave/cli/app.go:264 (0x19146ac)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/main.go:23 (0x19815de)
/usr/local/Cellar/go/1.13/libexec/src/runtime/proc.go:203 (0x10310ee)
/usr/local/Cellar/go/1.13/libexec/src/runtime/asm_amd64.s:1357 (0x105d141)

[terragrunt] 2019/09/06 16:28:56 Unable to determine underlying exit code, so Terragrunt will exit with error code 1
```

```
[terragrunt] 2019/09/06 16:29:42 configstack.MultiError Encountered the following errors:
Cannot process module Module /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web/security_groups (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/network]) because one of its dependencies, Module /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/network, /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/iam/users, /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web/security_groups]), finished with an error: Error reading file at path /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/terragrunt.hcl: no such file or directory
Cannot process module Module /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/iam/users (excluded: false, dependencies: []) because one of its dependencies, Module /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/network, /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/iam/users, /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web/security_groups]), finished with an error: Error reading file at path /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/terragrunt.hcl: no such file or directory
Cannot process module Module /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/network (excluded: false, dependencies: []) because one of its dependencies, Module /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web (excluded: false, dependencies: [/Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/network, /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/iam/users, /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web/security_groups]), finished with an error: Error reading file at path /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/terragrunt.hcl: no such file or directory
Error reading file at path /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/terragrunt.hcl: no such file or directory
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/configstack/running_module.go:179 (0x1971ff5)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/configstack/running_module.go:163 (0x1971e26)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/configstack/running_module.go:73 (0x197129d)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/configstack/stack.go:81 (0x1973c8f)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:729 (0x197c475)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:646 (0x197bd4b)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:223 (0x1978f76)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:206 (0x1978cd6)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/vendor/github.com/urfave/cli/app.go:490 (0x19164a8)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/vendor/github.com/urfave/cli/app.go:264 (0x19146ac)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/main.go:23 (0x19815de)
/usr/local/Cellar/go/1.13/libexec/src/runtime/proc.go:203 (0x10310ee)
/usr/local/Cellar/go/1.13/libexec/src/runtime/asm_amd64.s:1357 (0x105d141)

[terragrunt] 2019/09/06 16:29:42 Unable to determine underlying exit code, so Terragrunt will exit with error code 1
```
***

**yorinasub17** commented *Sep 6, 2019*

Can you share the entire log, of running `terragrunt plan` (NOT `plan-all`) on version `0.19.23`, in the directory `/Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web`? Everything else is helpful, but won't surface the critical issue because the stack trace will be swallowed by all the parallelism / wrong directory config.

The reason for this is because the `xxx-all` is failing in that module, so that module is the critical issue here and I need to see the stack trace where that module fails, not the wrapper functions (which is used in the `xxx-all` variant). And I believe you that this is a regression introduced in `0.19.23`, but since I can't reproduce this, I need the context from the logs + stack trace to piece together what might be going wrong.

Hope this makes sense.
***

**adoylesimplisafe** commented *Sep 6, 2019*

```
> pwd && terragrunt plan
/Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web
[terragrunt] 2019/09/06 16:44:58 Reading Terragrunt config file at /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/qa/us-east-2/services/web/terragrunt.hcl
[terragrunt] 2019/09/06 16:44:58 *os.PathError Error reading file at path /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/terragrunt.hcl: open /Users/andrewdoyle/ss_prototypes/terragrunt-poc/accounts/infra/environments/terragrunt.hcl: no such file or directory
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/util/file.go:126 (0x129de5a)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/config/config_partial.go:105 (0x1909079)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/config/config_partial.go:241 (0x1909a44)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/config/config_partial.go:221 (0x1909849)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/config/config_partial.go:110 (0x19090f9)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/config/dependency.go:145 (0x190b654)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/config/dependency.go:107 (0x190b145)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/config/dependency.go:81 (0x190aeab)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/config/dependency.go:49 (0x190a8f4)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/config/config.go:315 (0x1904011)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/config/config.go:262 (0x1903e1c)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/config/config.go:251 (0x1903d54)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:239 (0x1979076)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:225 (0x1978fa2)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/cli/cli_app.go:206 (0x1978cd6)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/vendor/github.com/urfave/cli/app.go:490 (0x19164a8)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/vendor/github.com/urfave/cli/app.go:264 (0x19146ac)
/private/tmp/terragrunt-20190905-24644-1lxwuhg/src/github.com/gruntwork-io/terragrunt/main.go:23 (0x19815de)
/usr/local/Cellar/go/1.13/libexec/src/runtime/proc.go:203 (0x10310ee)
/usr/local/Cellar/go/1.13/libexec/src/runtime/asm_amd64.s:1357 (0x105d141)

[terragrunt] 2019/09/06 16:44:58 Unable to determine underlying exit code, so Terragrunt will exit with error code 1```
***

**yorinasub17** commented *Sep 6, 2019*

Thanks! Will dig into this and report back findings.
***

**adoylesimplisafe** commented *Sep 6, 2019*

I really appreciate your help - I hope I'm not leading you down a rabbit hole due to a silly oversight on my part.  From here I think I'm going to start again from scratch to make sure I didn't fudge anything up during absent-minded debugging.  Similarly I'll report back if somehow I am able to resolve this issue.  Thanks! :)
***

**yorinasub17** commented *Sep 6, 2019*

The stack trace was very helpful. I was able to reproduce the issue and identify the problem. I have a fix in https://github.com/gruntwork-io/terragrunt/pull/855.

In the meantime, please continue to use `v0.19.21`
***

**yorinasub17** commented *Sep 9, 2019*

This is resolved in https://github.com/gruntwork-io/terragrunt/releases/tag/v0.19.24. Binaries will show up soon (~10 minutes). Can you try that once you see the binaries and close if it works?
***

**adoylesimplisafe** commented *Sep 9, 2019*

Will do, thank you for the quick turn around, very impressive!
***

**adoylesimplisafe** commented *Sep 9, 2019*

So far I have yet to run into the reported issue.  Thanks again!
***

**yorinasub17** commented *Sep 9, 2019*

Ok closing as fixed. Thanks for trying it out!
***

