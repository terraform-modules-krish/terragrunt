# No double-slash (//) found in source URL

**leiarenee** commented *Dec 28, 2021*

I'm fed up of this warning. I wish there was a way of disabling it. I'm using local modules that are in one single repository. 
<br />
***


**canidam** commented *Jan 28, 2022*

This seems to be an easy fix, and good for new comers. Is PR welcome for this issue?
***

**timblaktu** commented *Oct 31, 2022*

@leiarenee would you provide an example terragrunt project tree that uses local modules and exhibits this warning, including the relevant `terragrunt.hcl` and `*.tf` contents? I'm also using local modules and seeing this WARNing, and although I find it similarly annoying, I'm too new to terragrunt to _think_ that it's not telling me something I'm actually doing wrong.

Here's a simplified project of mine that produces this WARNing on `terragrunt run-all validate`. It also produces some "Unsupported Attribute in module dependency" errors I believe to be related to module source path declaration and or usage of relative paths and nested directory structure. I want to make sure I fully understand module source paths, relative paths (to dependencies' `config_path`, hooks' `execute` paths, ), and best practice here.

```
.  <---- Repo root dir has no config, just a container
├── backend.tf              # Generated by root 
├── globals.hcl
├── modules  <------------- No config, just a container
│   ├── terragrunt.hcl      Empty file
│   ├── account  <--------- No config, just a container
│   │   ├── data
│   │   │   ├── main.tf
│   │   │   └── terragrunt.hcl
│   │   └── terragrunt.hcl        # Empty
│   ├── region  <----------- No config, just a container
│   │   ├── data
│   │   │   ├── main.tf
│   │   │   └── terragrunt.hcl
│   │   └── terragrunt.hcl        # Empty
│   └── vpc
│       └── terragrunt.hcl
├── provider.tf             # Generated by root 
├── script  <--------------   All modules need access to
│   ├── colorfuncs.sh       # scripts/ at repo root to
│   ├── functions.sh        # call the before_hook
│   └── before-hook.sh
├── terraform.tfstate.d
│   └── proto67
├── terragrunt.hcl
└── versions_override.tf    # Generated by root 
```

I _feel_ I have tried all obvious permutations of specifying these paths in my .hcl files:

1. `terraform.source`
2. `terraform.before_hook.execute`
3. `dependency.config_path`

and using all various ways of specifying a path, e.g. for `modules/region/data`:

a. `"../../..//modules/region/data"`
b. `"${get_parent_terragrunt_dir()}//modules/region/data"`
c. `"${get_terragrunt_dir()}"  # I know this one's incorrect`

After an exhausting weekend of reading and experimenting, I now always use the infamous double-slash in `terraform.source`, but the requirements around its placement is still quite _fuzzy_.

What _IS_ clear is that regardless of the source being local or remote, the `//` MUST be early enough in the path to enable terragrunt to copy from the correct node in the directory tree to provide all code needed to be referenced in the temp dir that it runs from.

Bringing all these pieces and more together.. Although now that I'm:

1. Using the double-slash correctly, which in my case means always putting it just before `//modules` so that `script/before_hook.sh` and friends can be accessed from the terragrunt temp/cache dir for all modules
2. Using relative paths (a. above) everywhere
3. Using dependency mocking religiously (I think):
    1. `mock_outputs` in all `dependency` stanzas.
    2. _NOT_ using `skip_outputs` in _ANY_`dependency` stanzas.
        1. ..although I've tried skipping outputs to no avail.
    3. `mock_outputs_allowed_terraform_commands = ["fmt", "validate"]`
    4. `mock_outputs_merge_strategy_with_state = "deep_map_only"`
        1. ..although I've tried `"no_merge"` and `"shallow"` to no avail

...**`terragrunt run-all validate` is still producing unresolveable `Unsupported Argument` errors from terragrunt not recognizing the output name of a module declared elsewhere as a dependency.**
***

**leiarenee** commented *Oct 31, 2022*


I've solved this problem with a workaround like many others I guess by using '//' somewhere in local path.

Eg.  https://github.com/leiarenee/sf-infra/blob/main/infra/live/k8s-deploy/namespace/terragrunt.hcl
```terraform
source = "${get_parent_terragrunt_dir()}//library/terraform/modules/deploy-yaml"
```

Or 
```terraform
source = ".//terraform"
```

Where TF code is written directly under TG folder structure as in 
https://github.com/leiarenee/sf-infra/blob/main/infra/live/job-resources/terragrunt.hcl

So maybe we should close it and accept it as it is :-)

***

**timblaktu** commented *Oct 31, 2022*

@leiarenee thanks for your response. I've updated my previous post with much more detail about my use case and the errors I'm trying to resolve. 

@leiarenee @canidam Would you take a quick look at my above post and see if any config problems jump out at you? 

If this turns out to be unrelated to double-slashes in local module source paths, I can create a new issue, but as I'm so new to terragrunt, I'm still assuming this is cockpit error on my part. Thanks.

Also, @canidam I've traced [the line in `splitSourceUrl` that logs this warning over on my fork](https://github.com/timblaktu/terragrunt/blob/master/cli/tfsource/types.go#L241) back to [where it's called in `NewTerraformSource`](https://github.com/timblaktu/terragrunt/blob/master/cli/tfsource/types.go#L145), which is clearly happening just before [the `IsLocalSource` check, when the func becomes aware of whether the source is local or remote](https://github.com/timblaktu/terragrunt/blob/master/cli/tfsource/types.go#L150). I don't have the full picture here, but it looks like _iff we really wanted to silence this warning for local sources_ we may be able to either change order of operations here, or simply add a conditional branch around the logger call inside `SplitSourceUrl()`. But, **after reading and experimenting so much with local module sources and confirming that the double-slash is just as important for them as it is for remote URLs, I think we should not make any change here.**
***

**timblaktu** commented *Oct 31, 2022*

@leiarenee I looked over your repo, and it appears we're doing mostly similar things WRT the double-slash and using relative paths. One question I had was why do you use relative paths like `../` sometimes for `source` and other times you use the absolute: `"${get_parent_terragrunt_dir()}//some/module"`?

Also I don't understand how/if you're actually using mocked outputs there. I see your mock.hcl files, but don't see how they're being used. Do/did you actually run `terragrunt run-all validate` in your workflow, before deploying resources with `terragrunt run-all apply`? 

On the one hand the problem I'm having is a well-known limitation of terragrunt: you can't expect to validate before apply without setting up adequate mocks. But I believe I have set these up and am still encountering the "Unsupported attribute" issue.
***

**denis256** commented *Sep 11, 2023*

Improved checking of module path in https://github.com/gruntwork-io/terragrunt/releases/tag/v0.50.13
***

